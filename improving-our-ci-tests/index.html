<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-d40192b6385a012ab732.js" as="script"/><link rel="preload" href="/component---src-templates-blog-post-js-68f7aee6b59dd86a2cd6.js" as="script"/><link rel="preload" href="/path---improving-our-ci-tests-9fca48e484d53ea83a19.js" as="script"/><link rel="preload" href="/app-763d27f3b58a4b98dab9.js" as="script"/><link rel="preload" href="/commons-d27b2d4800120666d7b5.js" as="script"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><title data-react-helmet="true">Improving our CI tests | Engineering at MindLink</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.625 -apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}h1{margin-left:0;margin-right:0;margin-top:2.4375rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.21875rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h2{margin-left:0;margin-right:0;margin-top:1.625rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.40625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:hsla(0,0%,0%,0.53);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:calc(0.8125rem - 1px);padding-right:0;padding-top:0;margin-bottom:0.8125rem;border-left:4px solid hsla(0,0%,0%,0.13);color:hsla(0,0%,0%,0.53);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(0.8125rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:calc(0.8125rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(0.8125rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h3,h4,h5,h6{margin-bottom:0.8125rem;margin-top:1.625rem;}ol,ul{margin-left:2.03125rem;}li>ol,li>ul{margin-left:2.03125rem;}a{color:#4078c0;text-decoration:none;}a:hover,a:active{text-decoration:underline;}</style><style id="gatsby-inlined-css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100.50d27986.woff2) format("woff2"),url(/static/montserrat-latin-100.5e334eff.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic.8c070533.woff2) format("woff2"),url(/static/montserrat-latin-100italic.03e19243.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200.4343d3d9.woff2) format("woff2"),url(/static/montserrat-latin-200.f2022ecd.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic.116c4c4b.woff2) format("woff2"),url(/static/montserrat-latin-200italic.89614a60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300.d2ad295b.woff2) format("woff2"),url(/static/montserrat-latin-300.3a371ee0.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic.f6b6bf24.woff2) format("woff2"),url(/static/montserrat-latin-300italic.16521668.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400.240a8444.woff2) format("woff2"),url(/static/montserrat-latin-400.b20cc131.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic.86172bb8.woff2) format("woff2"),url(/static/montserrat-latin-400italic.9405e787.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500.fb8d6b71.woff2) format("woff2"),url(/static/montserrat-latin-500.50825d47.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic.c0a555a4.woff2) format("woff2"),url(/static/montserrat-latin-500italic.635de59c.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600.d5615136.woff2) format("woff2"),url(/static/montserrat-latin-600.f300da4f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic.10f29d13.woff2) format("woff2"),url(/static/montserrat-latin-600italic.2bc37d86.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700.7d77e1f0.woff2) format("woff2"),url(/static/montserrat-latin-700.81826529.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic.1dd2b53f.woff2) format("woff2"),url(/static/montserrat-latin-700italic.c162d257.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800.d4e7bf86.woff2) format("woff2"),url(/static/montserrat-latin-800.895aadbf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic.fc0cbe44.woff2) format("woff2"),url(/static/montserrat-latin-800italic.b3362875.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900.c8bdd772.woff2) format("woff2"),url(/static/montserrat-latin-900.1b99ef78.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic.cb72c1f9.woff2) format("woff2"),url(/static/montserrat-latin-900italic.b78bb9f8.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300.f015f1e9.woff2) format("woff2"),url(/static/merriweather-latin-300.92dfe81b.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic.7fd86b32.woff2) format("woff2"),url(/static/merriweather-latin-300italic.878b76f5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400.12dbf4c0.woff2) format("woff2"),url(/static/merriweather-latin-400.1fffad22.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic.1e0d3e81.woff2) format("woff2"),url(/static/merriweather-latin-400italic.de18d4c4.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700.dc8fec81.woff2) format("woff2"),url(/static/merriweather-latin-700.d7d2ed8e.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic.b7b7e5da.woff2) format("woff2"),url(/static/merriweather-latin-700italic.6210a5fc.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900.43f870d5.woff2) format("woff2"),url(/static/merriweather-latin-900.8f3806df.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic.168c1ab2.woff2) format("woff2"),url(/static/merriweather-latin-900italic.ae7778f0.woff) format("woff")}.footnote-backref{font-family:Cambria,Cochin,Georgia,Times,Times New Roman,serif}.footnotes p{display:inline}</style></head><body><div id="___gatsby"><div style="max-width:56.875rem;margin-left:auto;margin-right:auto;padding:2.4375rem 1.21875rem;" data-reactroot="" data-reactid="1" data-react-checksum="-259208618"><h3 style="margin-top:0;margin-bottom:-1.625rem;" data-reactid="2"><a style="box-shadow:none;text-decoration:none;color:inherit;display:flex;align-items:center;" href="/" data-reactid="3"><span style="width:2em;height:2em;background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPCEtLSBDcmVhdG9yOiBDb3JlbERSQVcgWDYgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiB3aWR0aD0iMzAuNDIxMWluIiBoZWlnaHQ9IjI0LjgwMzJpbiIgdmVyc2lvbj0iMS4xIiBzdHlsZT0ic2hhcGUtcmVuZGVyaW5nOmdlb21ldHJpY1ByZWNpc2lvbjsgdGV4dC1yZW5kZXJpbmc6Z2VvbWV0cmljUHJlY2lzaW9uOyBpbWFnZS1yZW5kZXJpbmc6b3B0aW1pemVRdWFsaXR5OyBmaWxsLXJ1bGU6ZXZlbm9kZDsgY2xpcC1ydWxlOmV2ZW5vZGQiCnZpZXdCb3g9IjAgMCAzMDQyMSAyNDgwMyIKIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KIDxkZWZzPgogIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgIDwhW0NEQVRBWwogICAgLmZpbDAge2ZpbGw6IzUxNTE1MTtmaWxsLXJ1bGU6bm9uemVyb30KICAgXV0+CiAgPC9zdHlsZT4KIDwvZGVmcz4KIDxnIGlkPSJfX3gwMDIzX0xheWVyX3gwMDIwXzEiPgogIDxtZXRhZGF0YSBpZD0iQ29yZWxDb3JwSURfMENvcmVsLUxheWVyIi8+CiAgPGcgaWQ9Il8yODc0MDYwMjQiPgogICA8cGF0aCBjbGFzcz0iZmlsMCIgZD0iTTIwNjUzIDE3MTE2YzQ3NSwtMjU3IDkxMywtNjM1IDEyODcsLTExMTIgNzQ2LC05NTMgMTIyNiwtMjMwMyAxMjI2LC0zODAzIDAsLTExMjYgLTI2OSwtMjE2NyAtNzIwLC0zMDE4IC00NTEsLTg1MyAtMTA4MCwtMTUxMiAtMTc5MywtMTg5NyAtNDc1LC0yNTcgLTk4NywtMzk1IC0xNTI2LC0zOTYgLTY1NiwxIC0xMjcyLDIwOCAtMTgzMiw1ODQgLTEyNCwxMjYgLTQ1NSw0NDcgLTk0Nyw3NzcgLTYxMCw0MDggLTE0NjgsODM5IC0yNDc4LDg0MyAtNTI0LDEgLTEwNTEsLTEyNSAtMTUyMCwtNDE4IC00NzEsLTI5MyAtODc0LC03NDEgLTExODksLTEzMzZsLTYzIC0xMTcgMCAtNTk4NWMyLC0yNDEgLTE0MywtNDQzIC0zNDUsLTUzNWwtMjg5IC01NyAtNTk4MCAwYy0xNjEsMCAtMzAzLDY1IC00MTAsMTczIC0xMDYsMTA4IC0xNzIsMjUzIC0xNzIsNDE5bDAgMTU2MDIgLTMxNjQgMzYxMSAzMTY0IDAgMCAyNzcwYzAsMTY2IDY1LDMxMiAxNzIsNDIwIDEwNiwxMDggMjQ5LDE3MSA0MTAsMTcxbDU5ODAgMCAyOTEgLTU2YzIwMCwtOTQgMzQ1LC0yOTUgMzQzLC01MzVsMCAtNjA0MSA2MyAtMTE2YzMxNiwtNTk4IDcxOCwtMTA0NyAxMTg5LC0xMzM4IDQ3MCwtMjkzIDk5NywtNDE5IDE1MjAsLTQxOSAxMDE0LDQgMTg3Myw0MzcgMjQ4Myw4NDYgNDg5LDMzMSA4MjEsNjUyIDk0NCw3NzkgNTU4LDM3NSAxMTc1LDU4MSAxODMwLDU4MSA1MzksMCAxMDUxLC0xMzcgMTUyNiwtMzk0eiIvPgogICA8cGF0aCBjbGFzcz0iZmlsMCIgZD0iTTI3MDA3IDM5MjJsMCAtMjY4NmMwLC0xNjYgLTY1LC0zMTIgLTE3MSwtNDE5IC0xMDgsLTEwOCAtMjUwLC0xNzIgLTQxMSwtMTczbC0xMzY4OSAwYy0xNTcsMiAtMjkzLDYxIC0zOTksMTYxIC0xMDAsOTYgLTE2NCwyMjQgLTE4MCwzNzFsMyAzOSAwIDU4NTVjNCw4MiAzNSwxNzEgMTI0LDI4NiA4OCwxMTEgMjM1LDIzNCA0MTQsMzM3IDM1NywyMTIgODQ4LDM0MiAxMTcyLDMzOCA2NzksNCAxMzU1LC0zMDcgMTg2MywtNjQ3IDUwNCwtMzM0IDgzNCwtNjgxIDgzOSwtNjg5bDQwIC00MyA0OCAtMzRjNzIyLC00OTkgMTU2OSwtNzkxIDI0NjcsLTc5MCA3MjMsLTEgMTQxNCwxODkgMjAzMCw1MjIgNjE4LDMzNSAxMTY0LDgxMiAxNjE4LDEzOTIgOTA3LDExNjEgMTQ0OSwyNzMyIDE0NTAsNDQ1OCAwLDEyOTMgLTMwNiwyNTAxIC04NDEsMzUxMyAtNTM1LDEwMTIgLTEzMDAsMTgzNCAtMjIyNywyMzM2IC02MTcsMzM0IC0xMzA4LDUyMyAtMjAzMCw1MjMgLTg5OSwxIC0xNzQ1LC0yOTIgLTI0NjcsLTc5MWwtNTAgLTM0IC00MCAtNDMgLTEgLTIgLTcgLTggLTM5IC00MGMtMzUsLTM1IC04OSwtODggLTE2MSwtMTUzIC0xNDEsLTEyNyAtMzQ5LC0zMDAgLTYwMywtNDcxIC01MDgsLTM0NSAtMTE5NiwtNjY3IC0xODg5LC02NjQgLTI4MCwwIC02MTAsNDQgLTg5NiwxNDEgLTI4OCw5NyAtNTE5LDI0NiAtNjUxLDQyMCAtODcsMTE0IC0xNDMsMjQxIC0xNjUsNDIwbDAgNTg5MiAtMiAyMSAtMiAyM2MxNSwxNDUgODAsMjczIDE3NywzNjggMTA0LDk4IDIzNiwxNTcgMzg5LDE1OWwxMzcwMyAwYzE2MSwwIDMwMywtNjMgNDExLC0xNzEgMTA2LC0xMDggMTcxLC0yNTQgMTcxLC00MjBsMCAtMTU3NTQgMzI0MSAtMzU0MyAtMzI0MSAweiIvPgogIDwvZz4KIDwvZz4KPC9zdmc+Cg==);background-size:contain;background-position:50%;background-repeat:no-repeat;" data-reactid="4"></span><!-- react-text: 5 -->Engineering at MindLink<!-- /react-text --></a></h3><div data-reactid="6"><!-- react-empty: 7 --><h1 data-reactid="8">Improving our CI tests</h1><p style="font-size:0.87055rem;line-height:1.625rem;display:block;margin-top:-0.8125rem;margin-bottom:1.625rem;" data-reactid="9">June 28, 2018</p><div data-reactid="10"><p>This is the story of how we:</p>
<ul>
<li>Enabled parallel NUnit test execution</li>
<li>Migrated our CI test stack to a reproduceable and self-contained configuration</li>
<li>Reduced our CI test run time by 65%</li>
</ul>
<h2>Background</h2>
<p>The MindLink .NET CI/test stack looks like:</p>
<ul>
<li>TFS 2018</li>
<li>NUnit</li>
<li>Moq</li>
</ul>
<p>For our main product repository, we have a CI build that runs on every server-side change. This builds our .NET components and then runs our tests. The tests are split between what we call “Unit Tests” and “Behaviour Tests”. The “Behaviour Tests” are still isolated in-memory tests, but run over chunky bits of the stack across component-level test seams. I’ll argue with you about what these should be called another time.</p>
<p>Our timings looked like this:</p>
<ul>
<li>Unit Tests - 18982 tests - 7:56 minutes</li>
<li>Behaviour Tests - 1769 tests - 3:34 minutes</li>
</ul>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/build-summary-initial-f6ac8293b032f89d16e6b8ece138dcc4-dd63b.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 44.60616438356164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABZ0lEQVQoz32SSU/DMBCF8+c5oQIS914ocODImQtLBYfyAxASCKmoSZzFzub9MXZKoVB1pKdxRvGXNzNJ2r6HlAbGuCjvHUTLwaocrE6RsiWy8hMFz1CKHFXDUIgMjKfrc45WcpKIShwBBqWgtEWIZqgxvT3A1dMprhdTzO4nOLs7xMX8GLOHCc6D5kdRoRby5ePJRkmASAK2nYaxHorOi9cbvLw/I199IFu9ISVVxRI1OQ3qyFnXFlF9zGzMVE88fHQoWk3ZwjkPBLOU4nlPOEdj0hrWGCgpYy1BBErUQqIhl0obNE1FX20ghz5e8t7/UwitaVR0d+g7sHxFOzBIrLPo+hE20HJGYI2ioGETNFwKsQtojI6QgT5csCw6TRRZblpFcxyX4kFbFhUEr2n7EtbaDfA7fhzqCN0Cbr0U5kZb57xEXZWxnf1AFaEByLJ1y3/bCP9h37fUNt8J+/1srYmQMOcAD/Uv6TqwtOYiPtMAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Build Summary"
        title=""
        src="/static/build-summary-initial-f6ac8293b032f89d16e6b8ece138dcc4-fb8a0.png"
        srcset="/static/build-summary-initial-f6ac8293b032f89d16e6b8ece138dcc4-1a291.png 148w,
/static/build-summary-initial-f6ac8293b032f89d16e6b8ece138dcc4-2bc4a.png 295w,
/static/build-summary-initial-f6ac8293b032f89d16e6b8ece138dcc4-fb8a0.png 590w,
/static/build-summary-initial-f6ac8293b032f89d16e6b8ece138dcc4-526de.png 885w,
/static/build-summary-initial-f6ac8293b032f89d16e6b8ece138dcc4-dd63b.png 1168w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>Whilst I’m sure there are definitely worse build times out there, a total time of 16 minutes definitely has room for improvement.</p>
<p>And yes, we can no doubt improve the 4:30 time for the core build, but that’s a different story.</p>
<h2>Parallelising Take 1</h2>
<p>Time to look at our test run configuration.</p>
<p>I was aware that the TFS Test runner will run tests in parallel - at the granularity of each test DLL. Our build servers have 2 processor cores. My presumption was that we could just enable parallelisation on our test task config, the test runner would farm off our 8 or so test DLLs to run in parallel (2 at a time), and we’d get a 2x speed up.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/original-test-settings-801a7cd9d090f2f3f9dc34883e194046-dfab2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 63.0272952853598%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABB0lEQVQ4y51T2W6DMBD0//9iH9smTQMYX2vwNdk1tJX6BKw0soSsYY61ouAxjU/GAGM0SimQaa0x6n4eh6K4wloHIo/gLSgEJs2ote7EODXKU4KxFusSESNBFMe4kV4ZtS4BM1smCqzQIackulhhuQSV0orAqn6ykxG7TdDOQ0l237d3jI87nB7h5qnbvQq1cG5CNj8fmL5uGO6fiOSvE4rv9q9Ksfxr+yS4lKWvTORS5JSWJdcecrlSyroTsvVOKoT8bVO5XZLCjkK9fXgMk+25ee92la6vkHO2/0gu1oNQ2niM8uxmDS0tW4OFl1xIcs5d4anFLjltitiqZ0WiLPXl/pszb/kFKSz/MeElCzAAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Original Test Settings"
        title=""
        src="/static/original-test-settings-801a7cd9d090f2f3f9dc34883e194046-fb8a0.png"
        srcset="/static/original-test-settings-801a7cd9d090f2f3f9dc34883e194046-1a291.png 148w,
/static/original-test-settings-801a7cd9d090f2f3f9dc34883e194046-2bc4a.png 295w,
/static/original-test-settings-801a7cd9d090f2f3f9dc34883e194046-fb8a0.png 590w,
/static/original-test-settings-801a7cd9d090f2f3f9dc34883e194046-dfab2.png 806w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>To my surprise/dismay - the “Run tests in parallel” box was already checked. So why are the tests still so slow? Is the parallelism not actually working?</p>
<p>I unchecked the box and queued another run. Same test timings. So what’s going on?</p>
<p><a href="https://blogs.msdn.microsoft.com/devops/2016/10/10/parallel-test-execution/">This Blog</a> helped me on my way (sort of). The parallel test run behaviour is a convoluted function of both the TFS GUI settings and the test .runsettings file. </p>
<p>Our .runsettings looked like</p>
<p><code class="language-text">&lt;MaxCpuCount&gt;0&lt;/MaxCpuCount&gt;</code></p>
<p>which apparently enables parallelisation by default.</p>
<p>Removing the .runsettings file from the test config altogether gave me what I was expecting - The unit tests alone now took 13 minutes (just under twice as long as before).</p>
<p>In hindsight, I could observe the tests running in parallel as the test runner launched. This is the log with parallelisation enabled:</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/test-execution-parallel-632cd4fb77c20ee0dceb4f5a20b32343-6b4b8.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 19.06614785992218%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA0klEQVQY0yWQ6W6DMBCEef/nq5qAbXxgCLSlHDZ2EyGmu86P0R6Wvpl1pXUDZyWcUeicRt9bjA9P6jBQ//M9YltnHMeOnAJSivjLR1HOEc9nwnWdAK5SK6XuaNsaWtUEVnCuxWPoinyn4b0p8N/5CyGsOOKOGDYkMmA4zzkxOL+BBUYyWqD3FtPYk0EDqyWskbQzWCkhAxgUtqWAw75gXWbEuBUY6zxfqIT4hJI3GIZYStc7SHGDqN/7pv6geifTplyh6I37aRoKONE38Omc8kXQf4dVKtbXMrUbAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Parallel Test Execution"
        title=""
        src="/static/test-execution-parallel-632cd4fb77c20ee0dceb4f5a20b32343-fb8a0.png"
        srcset="/static/test-execution-parallel-632cd4fb77c20ee0dceb4f5a20b32343-1a291.png 148w,
/static/test-execution-parallel-632cd4fb77c20ee0dceb4f5a20b32343-2bc4a.png 295w,
/static/test-execution-parallel-632cd4fb77c20ee0dceb4f5a20b32343-fb8a0.png 590w,
/static/test-execution-parallel-632cd4fb77c20ee0dceb4f5a20b32343-526de.png 885w,
/static/test-execution-parallel-632cd4fb77c20ee0dceb4f5a20b32343-6b4b8.png 1028w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>And this is the log with parallelisation disabled:</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/test-execution-sequential-ce046a022d9acebe8c8739111dc3a0ac-cccd3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 19.414634146341463%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAyElEQVQY01WQ226DMBBE+f8fbDC+hkvcJE2aYggUwqntplX7MNrRSjtztIU1FU1rsUayt5K6Nviu5hDVRH86dlyvZ0K4MYQP7mNgHPo8p2n49fN8Bx4U1giaxmC0wNmKrnXRV7nAWZX3qfTt7BnHnnWZWZYp68enua6fbNtCYXQZqTRK7mKAxB8ahHhBVru4E2gl8L6LB9/HieKftjUHZT1ioHOK9klV7w3H1xYbqbQsUap8UpaZMr3gcjkR+ht9/57fkMj+FnwByoQs6eHe7PwAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Sequential Test Execution"
        title=""
        src="/static/test-execution-sequential-ce046a022d9acebe8c8739111dc3a0ac-fb8a0.png"
        srcset="/static/test-execution-sequential-ce046a022d9acebe8c8739111dc3a0ac-1a291.png 148w,
/static/test-execution-sequential-ce046a022d9acebe8c8739111dc3a0ac-2bc4a.png 295w,
/static/test-execution-sequential-ce046a022d9acebe8c8739111dc3a0ac-fb8a0.png 590w,
/static/test-execution-sequential-ce046a022d9acebe8c8739111dc3a0ac-526de.png 885w,
/static/test-execution-sequential-ce046a022d9acebe8c8739111dc3a0ac-cccd3.png 1025w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>You can see it processing two DLL test containers at a time on test launch, and then subsequent test result logs overlap.</p>
<p>So - good news is: I’ve got to the bottom of what’s making the tests run in parallel. Bad news is: our tests runs are taking a long time even though they’re already running in parallel.</p>
<h2>Time for some housekeeping</h2>
<p>All this talk of test configuration got me thinking about our build dependencies.</p>
<p>We’re on the same path as a lot of teams with this one: we have several build servers that each have some global build dependencies installed. This means:</p>
<ul>
<li>When we make changes to the build, we need to make the same changes across all build servers</li>
<li>If we upgrade a build dependency for one branch, typically all the other branches start failing to build</li>
</ul>
<p>Our end goal however is:</p>
<ul>
<li>Remove as many global build agent dependencies as possible</li>
<li>Define all build dependencies in source code as versioned package dependencies</li>
<li>Dynamically install and configure the build environment as part of the build itself</li>
</ul>
<p>So couple of things to fix with our test configurations:</p>
<p><strong>.runSettings file</strong> - This guy was defined at a well known path on the build server, and had to be kept in sync between all servers. He seems to have been superceded by the TFS test task configuration, and he wasn’t doing much anyway (other than making things more confusing). So time for him to go. Parallel execution of tests is enabled by the TFS task config.</p>
<p><strong>Visual Studio Test Platform</strong> - This was installed as part of Visual Studio on the build server. Ultimately we want to reduce our dependency on needing Visual Studio on the build server, and let the agents upgrade themselves as required. We switched this to be installed by the TFS build agent. </p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/test-platform-settings-7aeaadfbf3558d7adba6434515e0f183-7492f.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 15.254237288135593%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAASklEQVQI152OyQ3AMAzDsv+0dXwV9aEm3aARwKcIDpqKOQkqDDNBxIPuxumGiIK3UBnuhsz8hKeM23fhBWGCm6KrUEta9ZP1yQy8Vp3sy6GLE94AAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Test Platform Settings"
        title=""
        src="/static/test-platform-settings-7aeaadfbf3558d7adba6434515e0f183-fb8a0.png"
        srcset="/static/test-platform-settings-7aeaadfbf3558d7adba6434515e0f183-1a291.png 148w,
/static/test-platform-settings-7aeaadfbf3558d7adba6434515e0f183-2bc4a.png 295w,
/static/test-platform-settings-7aeaadfbf3558d7adba6434515e0f183-fb8a0.png 590w,
/static/test-platform-settings-7aeaadfbf3558d7adba6434515e0f183-526de.png 885w,
/static/test-platform-settings-7aeaadfbf3558d7adba6434515e0f183-7492f.png 1003w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>This means adding another bootstrap step in the build tasks flow. In practice this task caches the installation between runs, so little extra overhead is added to the build process.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/test-platform-installer-task-425b1c27823ceeb1ddce7d6b4a86f188-02305.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 15.062111801242233%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAkElEQVQI14XPOQrCQABA0dz/LAGvYC0KCqLZTEKSWbJvM4FU38FasXjth++1okWLmixPKasSpRVSSYQzr+vHYsxf/ThgrMFLzgWn4xX/4HO7P1DtQCE1pWpohpm6n5jM/tPoLNtOPy0uvOFlUUMUK4JMEqaS4CWIc80zKUmKBtltVK1x7FeqtyRi5RJ27sbyBnWz4CLUpDyrAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Test Platform Installer Task"
        title=""
        src="/static/test-platform-installer-task-425b1c27823ceeb1ddce7d6b4a86f188-fb8a0.png"
        srcset="/static/test-platform-installer-task-425b1c27823ceeb1ddce7d6b4a86f188-1a291.png 148w,
/static/test-platform-installer-task-425b1c27823ceeb1ddce7d6b4a86f188-2bc4a.png 295w,
/static/test-platform-installer-task-425b1c27823ceeb1ddce7d6b4a86f188-fb8a0.png 590w,
/static/test-platform-installer-task-425b1c27823ceeb1ddce7d6b4a86f188-02305.png 644w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p><strong>NUnit Test Adaptors</strong> - We had these installed globally on each build server using the Visual Studio extension installer. I think this was the right decision when we intially set up the build servers, but the installing-as-nuget-dependency seems like the right way for us to go now. This will give us one less global dependency.</p>
<p>To do this, you just need to add the adaptor package to your test project’s NuGet package dependencies. Something does feel a little odd about adding another dependency <em>just because the build server needs it</em>, but that’s ultimately the shift in thinking towards self-describing builds.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/nunit-test-adaptor-nuget-725b45e7859bf262a5a083a41b902afd-de96f.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 4.058441558441558%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAARUlEQVQI1wXBAQqAIBAAwf7/SvHy0DMElRJK3WaO5hyfZSw8SIAUNyIb7+FuAy5jxUSxgUYYpcMpLFUQz0yZbBPVTa0vP/jQS+DoIDiuAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="NUnit Test Nuget Package"
        title=""
        src="/static/nunit-test-adaptor-nuget-725b45e7859bf262a5a083a41b902afd-fb8a0.png"
        srcset="/static/nunit-test-adaptor-nuget-725b45e7859bf262a5a083a41b902afd-1a291.png 148w,
/static/nunit-test-adaptor-nuget-725b45e7859bf262a5a083a41b902afd-2bc4a.png 295w,
/static/nunit-test-adaptor-nuget-725b45e7859bf262a5a083a41b902afd-fb8a0.png 590w,
/static/nunit-test-adaptor-nuget-725b45e7859bf262a5a083a41b902afd-de96f.png 616w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>I’m also not in love with the fact that you technically only need to do this for <em>one project in the solution</em> (I assume just so that when NuGet solution-restores everything it’s present in the packages folder), but I’ll let that one go for simplicity.</p>
<h2>Upgrading NUnit</h2>
<p>At this point I also decided to upgrade our test dependencies. We were using NUnit 3.6.0 at this stage. I updated our NuGet package config to bump this to the latest 3.10.0 libraries.</p>
<p>This did cause a couple of compilation errors, but nothing that wasn’t easily fixed with equivalent NUnit API constructs. I pushed and waited (16 minutes) for the build to finish.</p>
<p><strong>But the build only took 9 minutes</strong></p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/improved-build-time-43e45d56121fbcdf3e40bf8e4fc4162b-4adfa.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 35.762331838565025%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABEElEQVQoz4VRuU7EMBT0N/IFnH8ADTSI5Q8o4BfouCQatqahRFuDFljIsZvEd5xkeHY2RwFaS6PxGz+Nx8/s8HoLF09HuJwe42p6grPbXZzebBN2cH5/QNgPPCGe3O1tBHuePeDl9RHx/A3x5ztWiw+kX3MU0Td0lvaolQS0QrMGjAr1oMnAzFkLazWUNtAk2NLAVSWcsyhp38Fr1QglnfseV9lWq11gJmQejJqmwabVddR1Dc7zlosccbSAMSacMakKCE4QnG70yVww/w+doTE67JUUWC2TvmZcZCSkSOIfpElEI1FtmpFBn3Bde5Zk5JfgbULlZ+wNleIhoW8YG/w1gsFwSKjJKM+W9A/tk38B4DEI8UM5hqMAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Improved Build Time"
        title=""
        src="/static/improved-build-time-43e45d56121fbcdf3e40bf8e4fc4162b-fb8a0.png"
        srcset="/static/improved-build-time-43e45d56121fbcdf3e40bf8e4fc4162b-1a291.png 148w,
/static/improved-build-time-43e45d56121fbcdf3e40bf8e4fc4162b-2bc4a.png 295w,
/static/improved-build-time-43e45d56121fbcdf3e40bf8e4fc4162b-fb8a0.png 590w,
/static/improved-build-time-43e45d56121fbcdf3e40bf8e4fc4162b-526de.png 885w,
/static/improved-build-time-43e45d56121fbcdf3e40bf8e4fc4162b-4adfa.png 892w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>That’s right. The Unit tests now ran in 100 seconds, the Behaviour tests down to 2 minutes. You can see the difference between the build times from the build summary graph (the first two builds are before we upgraded NUnit).</p>
<p>After some digging, I <em>think</em> it’s <a href="https://github.com/nunit/nunit/issues/2217">this issue</a> that was the culprit. Indeed, even when I run from Resharper in Visual Studio, the tests now run lightning fast.</p>
<h2>Concluding</h2>
<p>I didn’t expect this investigation to turn out like this - our problems were solved just by upgrading our NUnit dependency.</p>
<p>On the other hand, we did clean up our test configuration and dependencies, and double-checked that we’re running our tests in parallel.</p>
<p>Moral of the story is:</p>
<blockquote>
<p>Make sure you’re on at least NUnit 3.8 so your tests run correctly!</p>
</blockquote>
<p>Next time: Further test parallelisation</p></div><hr style="margin-bottom:1.625rem;" data-reactid="11"/><div style="display:flex;margin-bottom:4.0625rem;align-items:flex-start;" data-reactid="12"><div class=" gatsby-image-outer-wrapper" style="position:relative;" data-reactid="13"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:60px;height:60px;margin-right:0.8125rem;margin-bottom:0;vertical-align:top;flex:none;" data-reactid="14"><img alt="Ben Osborne" src="data:image/svg+xml,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; width=&#x27;60&#x27; height=&#x27;60&#x27; viewBox=&#x27;0 0 60 60&#x27; version=&#x27;1&#x27;%3E%3Crect width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; fill=&#x27;%23f6f2f8&#x27;/%3E%3Cpath d=&#x27;M16 2c0 9 1 15 7 21l3 4c0 2-1 4-3 4-5 0-13 4-17 7-3 4-3 4-4 11 0 11-2 11 29 11 30 0 28 0 28-11-1-6-1-7-4-11-4-3-12-7-17-7-2 0-3-2-3-4l3-4c6-6 7-12 7-21 0-2 0-2-14-2-15 0-15 0-15 2M0 51l1 3v-7l-1 4&#x27; fill=&#x27;%23e0d6eb&#x27; fill-rule=&#x27;evenodd&#x27;/%3E%3C/svg%3E" style="position:absolute;top:0;left:0;transition:opacity 0.5s;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:0.25s;border-radius:100%;" data-reactid="15"/><noscript data-reactid="16"><img width="40" height="40" src="/static/default-788e71c2bb40c6a516ea06e9a06387eb-bad24.png" srcset="/static/default-788e71c2bb40c6a516ea06e9a06387eb-bad24.png 1x" alt="Ben Osborne" style="position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></noscript></div></div><div data-reactid="17"><p data-reactid="18"><!-- react-text: 19 -->Written by <!-- /react-text --><strong data-reactid="20">Ben Osborne</strong><!-- react-text: 21 -->.<!-- /react-text --></p><p style="color:#888888;" data-reactid="22">Craft beer and cats.</p></div></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0;" data-reactid="23"><li data-reactid="24"><a rel="prev" href="/end-to-end-encryption-with-the-signal-protocol" data-reactid="25"><!-- react-text: 26 -->← <!-- /react-text --><!-- react-text: 27 -->End-To-End Encryption with the Signal Protocol<!-- /react-text --></a></li><li data-reactid="28"><a rel="next" href="/mixin-that-memory-leak" data-reactid="29"><!-- react-text: 30 -->Mixin that memory leak<!-- /react-text --><!-- react-text: 31 --> →<!-- /react-text --></a></li></ul><hr style="margin-bottom:1.625rem;" data-reactid="32"/><div class="utterances-placeholder" data-reactid="33"></div></div><span style="display:block;clear:both;" data-reactid="34"> </span></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-763d27f3b58a4b98dab9.js","99219681209289":"component---node-modules-gatsby-plugin-offline-app-shell-js-5c4c5a0f7af9dc69d6d7.js","107818501498521":"component---src-templates-blog-post-js-68f7aee6b59dd86a2cd6.js","162898551421021":"component---src-pages-404-js-4503918ea3a16cfcdb75.js","35783957827783":"component---src-pages-index-js-1bc116d76406ca9e28a9.js","60335399758886":"path----93acfddfa4afcd4dbca4.js","210333531512890":"path---offline-plugin-app-shell-fallback-a0e39f21c11f6a62c5ab.js","78213438093281":"path---getting-started-with-python-and-the-mindlink-api-523d1ef67687379adc62.js","210078362639055":"path---parallelizing-our-ci-tests-12443dae833d0661bfa6.js","175624018417515":"path---mixin-that-memory-leak-32b3c40d6cc8b97792c1.js","276876481256213":"path---improving-our-ci-tests-9fca48e484d53ea83a19.js","470145679688":"path---end-to-end-encryption-with-the-signal-protocol-e4594a8f6ca366fe37f0.js","3348540548791":"path---creating-a-private-ethereum-blockchain-and-using-it-as-a-model-b8248be064453a9bbab7.js","158181132903248":"path---custom-content-in-a-skype-for-business-conversation-f7bf51fb6fa1a5d44e17.js","10959833468015":"path---leveraging-rasa-to-build-on-premise-intelligent-chat-bots-b2c2f5228625308d7484.js","128816527069367":"path---why-draftjs-doesnt-work-on-android-919a9fa332b8d92d4d13.js","242332654075282":"path---publishing-to-github-pages-from-tfs-efe42a166c6643254c7b.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-7053bfa1ba0025b4841f.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-d40192b6385a012ab732.js"}/*]]>*/</script><script>
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'undefined', 'auto');
      }
      </script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/commons-d27b2d4800120666d7b5.js","/app-763d27f3b58a4b98dab9.js","/path---improving-our-ci-tests-9fca48e484d53ea83a19.js","/component---src-templates-blog-post-js-68f7aee6b59dd86a2cd6.js","/component---src-layouts-index-js-d40192b6385a012ab732.js"])/*]]>*/</script></body></html>